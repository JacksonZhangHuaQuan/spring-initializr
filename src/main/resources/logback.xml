<?xml version="1.0" encoding="UTF-8"?>
<configuration>

    <springProperty scope="context" name="accessKeyId" source="log.aliyun.accessKeyId" defaultValue="xxxx"/>
    <springProperty scope="context" name="accessKey" source="log.aliyun.accessKey" defaultValue="xxxx"/>
    <springProperty scope="context" name="endpoint" source="log.aliyun.endpoint" defaultValue="xxxx"/>


    <!-- 控制台输出日志 -->
    <appender name="Console" class="ch.qos.logback.core.ConsoleAppender">
        <!-- encoders are  by default assigned the type
             ch.qos.logback.classic.encoder.PatternLayoutEncoder -->
        <encoder>
            <pattern>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</pattern>
        </encoder>
    </appender>

    <!--为了防止进程退出时，内存中的数据丢失，请加上此选项-->
    <shutdownHook class="ch.qos.logback.core.hook.DelayingShutdownHook"/>

    <appender name="alilog" class="com.aliyun.openservices.log.logback.LoghubAppender">
        <!--必选项-->
        <!-- 账号及网络配置 -->
        <endpoint>${endpoint}</endpoint>
        <accessKeyId>${accessKeyId}</accessKeyId>
        <accessKey>${accessKey}</accessKey>

        <!-- sls 项目配置 -->
        <projectName>start-jetbrains-org-cn</projectName>
        <logstore>start-jetbrains-org-cn</logstore>
        <!--必选项 (end)-->

        <!-- 可选项 -->
        <!--<topic>topic1</topic>-->

        <!-- 可选项 详见 '参数说明'-->
        <packageTimeoutInMS>3000</packageTimeoutInMS>
        <logsCountPerPackage>4096</logsCountPerPackage>
        <logsBytesPerPackage>3145728</logsBytesPerPackage>
        <memPoolSizeInByte>104857600</memPoolSizeInByte>
        <retryTimes>3</retryTimes>
        <maxIOThreadSizeInPool>8</maxIOThreadSizeInPool>

        <!--<filter class="ch.qos.logback.classic.filter.ThresholdFilter">&lt;!&ndash; 打印WARN,ERROR级别的日志 &ndash;&gt;-->
        <!--<level>INFO</level>-->
        <!--</filter>-->
    </appender>


    <appender name="logstash" class="net.logstash.logback.appender.LogstashTcpSocketAppender">
        <!--<param name="Encoding" value="UTF-8"/>-->
        <remoteHost>127.0.0.1</remoteHost>
        <port>5000</port>
        <!-- encoder is required -->
        <encoder class="net.logstash.logback.encoder.LogstashEncoder"/>
    </appender>

    <root level="DEBUG">
        <appender-ref ref="Console"/>

    </root>
    <root level="INFO">
        <appender-ref ref="logstash"/>
        <appender-ref ref="alilog"/>
    </root>
</configuration>